(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,61668,61664,t=>{"use strict";var a=t.i(43476),e=t.i(71645);function r(){return(window.__ENV__?{apiUrl:window.__ENV__.NEXT_PUBLIC_API_URL||"/api"}:{apiUrl:"/api"}).apiUrl}t.i(47167),t.s(["dapatkanApiUrl",()=>r],61664);let i=t=>{localStorage.setItem("access_token",t)},o=()=>{localStorage.removeItem("access_token")},n=async(t,a)=>{let e=r(),o=await fetch(`${e}/api/auth/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:t,password:a})});if(!o.ok)throw Error((await o.json()).detail||"Login gagal");let n=await o.json();return i(n.access_token),n},l=async(t,a,e)=>{let o=r(),n=await fetch(`${o}/api/auth/register`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:t,password:a,nama:e})});if(!n.ok)throw Error((await n.json()).detail||"Registrasi gagal");let l=await n.json();return i(l.access_token),l},s=async()=>{let t=localStorage.getItem("access_token");if(!t)throw Error("Tidak ada token, silakan login");let a=r(),e=await fetch(`${a}/api/auth/me`,{headers:{Authorization:`Bearer ${t}`}});if(!e.ok){if(401===e.status)throw o(),Error("Token expired, silakan login lagi");throw Error("Gagal mengambil profil")}return e.json()},c=(0,e.createContext)(void 0);function u({children:t}){let[r,i]=(0,e.useState)(null),[u,d]=(0,e.useState)(!0),[h,g]=(0,e.useState)(!1);(0,e.useEffect)(()=>{(async()=>{if(localStorage.getItem("access_token"))try{let t=await s();i(t)}catch(t){console.error("Token expired atau invalid:",t),i(null)}d(!1)})()},[]);let p=async(t,a)=>{g(!0);try{let e=await n(t,a);i(e.user)}finally{g(!1)}},f=async(t,a,e)=>{g(!0);try{let r=await l(t,a,e);i(r.user)}finally{g(!1)}},k=r?.role==="admin";return(0,a.jsx)(c.Provider,{value:{pengguna:r,sedangMemuat:u,sedangMasuk:h,apakahAdmin:k,masuk:p,daftar:f,keluar:()=>{o(),i(null)}},children:t})}function d(){let t=(0,e.useContext)(c);if(void 0===t)throw Error("gunakanAuth harus digunakan di dalam ProviderAuth");return t}t.s(["ProviderAuth",()=>u,"gunakanAuth",()=>d],61668)}]);